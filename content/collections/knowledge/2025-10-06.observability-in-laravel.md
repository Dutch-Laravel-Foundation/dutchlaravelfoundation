---
id: ea5890c7-4a8e-4f7f-a02e-7bb6502fc9f7
blueprint: knowledge
title: 'Observability in Laravel'
featured_image: 59915.jpg
introduction: 'Er komt een punt waarop je website of webapplicatie begint te groeien en het steeds drukker wordt. Daardoor wordt het steeds belangrijker dat deze snel en beschikbaar blijft. Je wil natuurlijk niet de hele dag je website F5’en, maar wél met een gerust gevoel naar bed gaan, in de wetenschap dat je een bericht krijgt in het geval er toch iets mis gaat. Observability is daarvoor de oplossing, en het is meer dan alleen een alert krijgen wanneer er iets fout gaat.'
category: Tooling
highlight: true
updated_by: 50ac328e-5084-4c6e-9551-2fb5bb9f3d88
updated_at: 1760600987
---
Er komt een punt waarop je website of webapplicatie begint te groeien en het steeds drukker wordt. Daardoor wordt het steeds belangrijker dat deze snel en beschikbaar blijft. Je wil natuurlijk niet de hele dag je website F5’en, maar wél met een gerust gevoel naar bed gaan, in de wetenschap dat je een bericht krijgt in het geval er toch iets mis gaat.

Observability is daarvoor de oplossing, en het is meer dan alleen een alert krijgen wanneer er iets fout gaat. Het geeft je diepgaand inzicht in je applicatie: de huidige staat én hoe bepaalde problemen zijn ontstaan of welke punten je kan optimaliseren. Daardoor kun je incidenten vroegtijdig voorkomen of verhelpen, en de oplostijd (lagere MTTR) terugdringen wanneer er toch iets misgaat.

Het grote probleem bij het implementeren van Observability is dat je data vaak decentraal word opgeslagen en verwerkt. Hierdoor mis je de kracht van het correleren van gebeurtenissen. Daarnaast is Observability ook niet iets wat je één keer configureert. Dit moet leven binnen de ontwikkelaars en door de beheerders van het onderliggende platform. Door continue verbeteringen door te voeren en extra inzichten toe te voegen.

![Grafana](https://dutchlaravelfoundation.nl/assets/uploads/knowledge/laravel-outline-v2.jpg)
<br>


## Kernconcepten: logs, metrics, traces
Als je inzicht wil krijgen in je applicatie, kom je altijd uit bij de ‘three pillars of observability’: logs, metrics en traces.

Met logs wil je achterhalen wat er is gebeurd. Welke soorten verzoeken zijn er op je applicatie binnengekomen? Zijn er foutmeldingen geweest? Debug-informatie helpt om dieper inzicht te krijgen in wat je applicatie tijdens een verzoek doet.

Met metrics maak je een momentopname van de huidige staat van je applicatie: hoeveel verzoeken komen er binnen, hoeveel verkeer is er, en treden er meer fouten op dan normaal? Dit is ideaal voor het maken van alerts en dashboards. Het geeft een goede indicatie van de gezondheid van je applicatie en kan snel signaleren wanneer er iets misgaat.

Traces gebruik je om diep je applicatie in te gaan. Daarmee volg je een verzoek vanaf de browser van de klant, door de applicatie heen, tot aan de database. Zo kun je bottlenecks vinden of exact bepalen waar het misgaat. Traces zet je meestal in nadat je een alert hebt gekregen of een specifieke vraag van de klant, om meer informatie te verzamelen en een mogelijke fix te bepalen.

![Logs, metrics, traces](https://dutchlaravelfoundation.nl/assets/uploads/knowledge/logs-metrics-traces-diagram.png)
<br>


## Laravel-eigen tooling
Een goed begin is de tooling te gebruiken die Laravel zelf aanbiedt: te beginnen met [Laravel/Monolog](https://laravel.com/docs/12.x/logging){:target="_blank"} voor logs, en verder Telescope en Pulse.

Laravel gebruikt standaard [Monolog](https://github.com/Seldaek/monolog){:target="_blank"} als logging-engine. Hiermee kun je snel verschillende channels aanmaken om je logs te verwerken. Voorbeelden hiervan zijn het wegschrijven naar een logbestand, het sturen van berichten naar Slack of het aanpassen van specifieke soorten logdata (denk aan debug- of tracinginformatie) en het automatiseren van logrotatie.

Om te starten met het debuggen van je Laravel-omgeving kun je de [Laravel Debugbar](https://github.com/barryvdh/laravel-debugbar){:target="_blank"} gebruiken. Dit is een laagdrempelige manier om je ontwikkelomgeving te debuggen en geeft snel inzicht in onder andere queries, routes en events. Let er wel op dat deze plug-in niet in productie draait, omdat hij informatie kan lekken over opgeslagen verzoeken.

[Telescope](https://laravel.com/docs/12.x/telescope){:target="_blank"} is ideaal voor ontwikkelomgevingen, want Telescope registreert alle requests, queries, cache-aanroepen, jobs, exceptions, mail, notificaties en meer. Hierdoor krijg je een goed overzicht van wat er op dat moment gebeurd, bijvoorbeeld wanneer er zware queries in de backend draaien.

[Laravel Pulse](https://pulse.laravel.com/){:target="_blank"} verzorgt een lichte vorm van [APM](https://en.wikipedia.org/wiki/Application_performance_management){:target="_blank"}. Je kunt hierin (bijna) realtime trage endpoints, langzame jobs, N+1-hits en actieve gebruikers terugvinden. Dit geeft een goede initiële indicatie en is perfect voor gebruik in productieomgevingen.

![Logs](https://dutchlaravelfoundation.nl/assets/uploads/knowledge/logs.png)
<br>

## The Next level
Je hebt nu een goed initieel inzicht in je applicatie en kunt in grote lijnen reageren op incidenten. Wil je de volgende stap zetten naar een volwaardige APM-oplossing, dan zijn er verschillende opties.

Denk aan [Grafana](https://grafana.com/){:target="_blank"}, [Datadog](https://www.datadoghq.com/){:target="_blank"} of [New Relic](https://newrelic.com){:target="_blank"}. Al deze opties bieden de mogelijkheid om je logs, traces en metrics te verzamelen en in een centraal overzicht weer te geven. Je kunt kiezen om je eigen stack te hosten met bijvoorbeeld Grafana’s LGTM-stack (Loki = logs, Grafana = webinterface, Tempo = traces, Mimir = metrics) of voor een gehoste oplossing zoals Datadog of New Relic.

Ook Laravel biedt hiervoor een dienst aan, genaamd [Nightwatch](https://nightwatch.laravel.com/){:target="_blank"}. Hiermee kun je eenvoudig je Laravel-applicatie onboarden door een agent op je systeem te draaien. Vervolgens krijg je in het Nightwatch-dashboard inzicht in het gedrag van je applicatie, inclusief responstijden en verzoeken, specifieke traces en logs.

Ook een bekende is de [ELK-setup](https://www.elastic.co/elastic-stack){:target="_blank"}, waarin we Elasticsearch gebruiken als datastore, Logstash als collector en Kibana als viewer. Dit ecosysteem staat bekend om razendsnel door een grote hoeveelheid data te zoeken.

Maak je je zorgen over eventuele vendor lock-in, dan kun je gebruikmaken van [OpenTelemetry](https://opentelemetry.io/){:target="_blank"}. Dit is een framework dat het mogelijk maakt om verschillende observability-typen te verzamelen en naar een backend te versturen. Die backend kan nog steeds een van de hierboven genoemde platformen zijn.

![Grafana](https://dutchlaravelfoundation.nl/assets/uploads/knowledge/grafana.png)

Om dit eenvoudiger te maken kun je gebruikmaken van [Kubernetes](https://kubernetes.io/){:target="_blank"}. Daarin kun je de mogelijkheden voor autodetectie benutten. Zo kan [Prometheus](https://prometheus.io/){:target="_blank"} detecteren welke applicaties binnen het cluster zijn opgestart en automatisch de bijbehorende metrics ophalen. Een andere goede optie is de OpenTelemetry-operator, die de collectors en de auto-instrumentatie van je applicatie verzorgt, zodat dit niet handmatig geconfigureerd hoeft te worden.

Als voorbeeld: binnen onze Shock Media Kubernetes-clusters gebruiken we [Fluent Bit](https://fluentbit.io/){:target="_blank"} in combinatie met [OpenSearch](https://opensearch.org/){:target="_blank"}. Dat zorgt ervoor dat we grote hoeveelheden logdata kunnen indexeren en snel beschikbaar maken voor klanten, zodat bij een (aankomend) probleem de logs direct inzichtelijk zijn. Dit combineren we met metrics uit Prometheus in een Grafana-dashboard. De kracht van Grafana ligt in het aanmaken van applicatiespecifieke dashboards, waarin je precies ziet hoe je applicatie zich gedraagt. 
Het doel is om problemen snel te detecteren en op te lossen. Binnen ons observability portal heb je vervolgens alle data op één plek.
<br>

## Conclusie
Het draaien van een productie-website brengt de nodige uitdagingen met zich mee. Observability neemt die niet allemaal weg, maar biedt zeker houvast en helpt ervoor te zorgen dat je applicatie kan meegroeien met je klantengroep.

Mocht je vast lopen bij het opzetten van Observability dan kun je gebruik maken van onze [Shock Media hosting hotline](https://dutchlaravelfoundation.nl/nieuws/hosting-hotline-geopend). Hier kunnen adviezen geven over hoe je de eerste stappen kunt maken.
<br/>

## Over de auteur
Dit artikel is geschreven door [Sven Mollinga](https://www.linkedin.com/in/svenmollinga/){:target="_blank"}, CTO bij [Shock Media B.V.](https://www.shockmedia.nl/){:target="_blank"}. Als partner en sponsor verzorgt Shock Media om de maand een gastartikel voor de Dutch Laravel Foundation waarbij zij hun kennis delen met betrekking tot het hosten en beveiligen van Laravel applicaties.